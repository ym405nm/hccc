<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="robots" content="noindex,nofollow" />
<title>Ktai Style 改版履歴</title>
<style type="text/css">
h1 {text-align:center;}
h2 {color:white; background: maroon;}
dt {font-weight:bold; background: #ffcccc; margin-right:25%;}
dd {margin:0.5em;}
li {line-height:1.5em;}
.navi {text-align:center;}
</style>
</head>
<body>
<h1>Ktai Style マニュアル</h1>
<p class="navi">[ <a href="../README.ja.html">はじめに</a> | <a href="HISTORY.ja.html">改版履歴</a> | <a href="CUSTOMIZE.ja.html">サイト設定とテンプレートの改造</a> | <a href="ADMIN.ja.html">ウェブログ管理機能</a> | <a href="Q_and_A.ja.html">よくある質問と答え</a> ]</p>

<h2>改版履歴</h2>

<p>※アップグレード時は「<a href="../README.ja.html#upgrade">以前のバージョンからの更新方法</a>」も必読です。</p>

<dl>
<dt id="ver205">ver 2.0.5 (2011-08-21)</dt>
<dd><ul>
  <li>スマートフォン (iPhone, Android, BlackBerry) 向けのテーマ個別設定が効いていなかった不具合を修正しました。</li>
  <li>WordPress 3.1 以降で、携帯向けダッシュボードとプロフィール編集パネルを再度有効にしました。</li>
</ul></dd>
<dt id="ver204">ver 2.0.4 (2011-08-18)</dt>
<dd><ul>
  <li>コメント表示でリスト要素の閉じタグを出力されていなかった不具合を直しました。これにより iPhone/iPod touch での構文エラーがなくなります。</li>
  <li>a 要素の内側で img 要素の外にある文字列が無視されるバグを直しました (例: <code>&lt;a href="XXXX"&gt;無視されていた&lt;img src="YYYY" /&gt;&lt;/a&gt;</code>)</li>
  <li>WordPress 3.0 以降のマルチサイトで画像の扱いをシングルサイトと同じにしていた不具合を直しました。</li>
  <li>WordPress 3.1 以降では携帯向け管理機構を停止するようにしました。コメント編集パネルが正常に動作しないためです。</li>
  <li>ページ編集で「編集をキャンセル」「リストに戻る」リンクが出なかった不具合を修正しました。</li>
  <li>SSL 接続時は端末 ID (iモードID, サブスクライバID 等) を「取得できない状態」と判断するようにしました。具体的には <code>ks_is_require_term_id()</code> が false になります。</li>
  <li><code>ks_in_network()</code> を、携帯4社のIPアドレス最新版に追従しました。</li>
  <li><code>ks_term_name()</code> を、au 最新機種に追従しました。</li>
</ul></dd>
<dt id="ver202">ver 2.0.3 (2010-05-13)</dt>
<dd><ul>
  <li>Classic, Default テーマの footer.php で HTML 文法違反があったのを修正しました。</li>
  <li><code>ks_term_name()</code> が一部の EZweb 端末の名前を正しく表示しないバグを修正しました。</li>
</ul></dd>
<dt id="ver202">ver 2.0.2 (2010-04-22)</dt>
<dd><ul>
  <li>無限ループになって HTTP 502 エラーなどが発生してしまう問題 (Ktai Style 2.0.1.1 で発生) を修正しました。</li>
  <li>PC テーマで P2 を使っている場合、携帯テーマのプレビューが白紙画面になる問題を修正しました。</li>
  <li>mbstring 拡張がない PHP での互換性を向上させました。</li>
</ul></dd>
<dt id="ver201_1">ver 2.0.1.1 (2010-04-20)</dt>
<dd><ul>
  <li><code>ks_in_network()</code> をソフトバンクの IP アドレス帯域変更に追随させました。</li>
</ul></dd>
<dt id="ver201">ver 2.0.1 (2010-04-20)</dt>
<dd><ul>
  <li>Apple iPad で携帯表示をしないようにしました。</li>
  <li>alt 属性がない画像が表示されない不具合を修正しました。(Ktai Style 2.0.0 のバグ)</li>
  <li>Windows サーバーで、画像のパスに数字のみの階層があるとき画像が表示されない不具合を修正しました。</li>
  <li>ログインセッションの有効期限が過ぎたとき、ログインフォームにメッセージを出すようにしました。</li>
  <li>クッキーが使えない端末では、携帯管理パネルでセキュリティー注意を表示するようにしました。</li>
  <li>現在の携帯テーマが ktai-themes ディレクトリーのものの場合、携帯テーマの一覧から現在の携帯テーマが除外されるようにしました。</li>
</ul></dd>
<dt id="ver200">ver 2.0.0 (2010-03-22)</dt>
<dd><ul>
  <li>対応する WordPress バージョンを 2.8 以降としました。</li>
  <li>配布サイトを WordPress 公式プラグインディレクトリーに変更しました。WordPress Plugins/JSeries は日本語での説明を行うページとして継続利用します。</li>
  <li>管理パネルの設定項目を「設定」ツリーから、独立した「携帯表示」ツリーに移動しました。</li>
  <li>「3G 端末, ウィルコム, スマートフォン等での画像表示」設定を廃止しました。サムネイル画像を表示、に決め打ちとなります。</li>
  <li>携帯テーマの選択を、スクリーンショットの一覧から選択できるようにしました。ただし、キャリア別テーマの設定は従来通りプルダウンメニューです。</li>
  <li>クッキー対応端末ではログイン機能をクッキーを使うようにしました。これにより、クッキー対応端末では以下の機能に対応しました。<ul>
    <li>ログイン状態のまま携帯サイトを閲覧できるようにしました。</li>
    <li>コメント投稿時にログインしたときも、ログイン状態を継続するようにしました。</li>
    <li>自身が編集できる投稿・ページ/. コメントについては、閲覧時に「編集」リンクが出るようにしました。</li>
   </ul></li>
  <li>ドコモ mova およびソフトバンク PDC でのログイン機能を廃止しました。</li>
  <li>附属テーマにおいて、コメント投稿フォームにあるログアウトのリンクをクリックしたとき、ログイン画面に戻るのではなく、元の投稿フォームに戻るようにしました。</li>
  <li>WordPress 2.9 のゴミ箱機能に対応しました。</li>
  <li>WordPress 2.9 にて、時々 PC 閲覧時に携帯テーマをロードしようとして白紙画面または PHP エラーになる現象に対処しました。(<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=20238">チケット#20238</a>)</li>
  <li>WordPress 2.9 において、携帯管理パネルの投稿一覧／ページ一覧におけるコメント数が不正 (コメント0件なのに「2」と表示される等) になる現象に対処しました。</li>
  <li>モバゲータウン、はてなモバイルゲートウェイからのクロールを検索エンジンとして認識するようにしました。</li>
  <li><code>mbstring.encoding_translation = On</code> の環境でも文字化けしないようにしました。</li>
  <li>携帯テーマの出力時においても、現在使用中の PC テーマにある functions.php を実行するようにしました。</li>
  <li>Ktai Style 1.00 から導入した、<code>get_stylesheet(), get_template(), load_theme_textdomain()</code> 等の結果を携帯テーマに振り替える機構を廃止しました。これらのテンプレートタグは PC 向けテーマを返します。携帯テーマを得るには <code>ks_get_theme(), ks_get_theme_directory(), ks_get_theme_uri()</code> などを使ってください。</li>
  <li><code>ks_term_name()</code> は、デフォルトで携帯用検索エンジンの名前を返すようにしました。検索エンジンが名乗る携帯端末名を取得する場合は <code>ks_term_name(KTAI_NOT_ECHO, false);</code> としてください。</li>
  <li><code>ks_login_link()</code> の before パラメーターの初期値を空白に変更しました。</li>
  <li>redir/ktai_style.php フィルターを廃止しました。redir.php テンプレートをご利用ください。</li>
  <li>独自フィルターフックの名称を XXXXX/ktai_style.php → ktai_XXXXX に変更しました。当面は従来の名称が使えますが、早い目に変更をお願いします。</li>
  <li>定数「KS_なんちゃら」のすべてを「KTAI_なんちゃら」に変更しました。</li>
</ul></dd>
<dt id="ver18xbranch">ver 1.83</dt>
<dd>(ver 1.83〜1.99 は別ブランチとなりました。変更点は 1.8x 系のパッケージ同梱の改版履歴を参照してください)</dd>
<dt id="ver182">ver 1.82 (2010-03-06)</dt>
<dd><ul>
  <li>au 新機種およびイー・モバイル H31IA に対応しました。</li>
  <li><a href="http://wordpress.org/extend/plugins/wp-latex/">WP LaTeX プラグイン</a>が出力する数式画像をそのまま表示させるようにしました。</li>
  <li>検索エンジンに対しては外部サイトへのリンクを中継ページ経由ではなく直接リンクするようにしました (時間がたつと中継ページへのリンクがエラーになるため)。</li>
  <li>設定パネルで「投稿・コメントの日時書式」の設定を変更しようとしても反映されない不具合を修正しました (Ktai Style 1.80, 1.81 の不具合)。</li>
  <li>WordPress の管理パネルから Ktai Style プラグインの削除が正しく行えない不具合を修正しました。</li>
  <li>携帯管理パネルで、投稿／ページ／コメントに入力したバックスラッシュが消えてしまう不具合を修正しました (これは SQL インジェクション脆弱性ではありません)。</li>
  <li><code>ks_in_network()</code> を au およびウィルコムの IP アドレス帯域変更に対応させました。</li>
  <li>ks_image_alignment フィルターを ktai_image_alignment に名称変更しました。</li>
</ul></dd>
<dt id="ver181">ver 1.81 (2009-12-25)</dt>
<dd><ul>
  <li>携帯対応ブログの URL として、新たに <a href="http://drecomblog.office.drecom.jp/faq/category_7/">ドリコムブログ</a>、<a href="http://www.ninja.co.jp/faq/category/7_5/">忍者ブログ</a>(blog.shinobi.jp ドメインのみ) の URL を認識するようにしました。これらのブログは中継ページを出さずに直接リンクします。</li>
  <li>WP Super Cache への対応方法を変更しました。これにより、Ktai Style 1.80 において、WP Super Cache と併用したときに発生していた不具合が解消されます (<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=19919">チケット#19919</a>)。</li>
  <li>サーバーの PHP が 5.1 以降、かつ、タイムゾーンの設定が世界標準時よりもプラス (グリニッジ子午線より東の地域) の場合、WordPress 2.9 において携帯管理機構にログインできないことがある不具合を改善しました。</li>
  <li>Ktai Style 1.80 において、ビジュアルエディタで img 要素の class 属性が消えることがある問題、&lt;!--more--&gt; が挿入できない問題を修正しました。(<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=19918">チケット#19918</a>)</li>
  <li>Ktai Style 1.80 において、携帯の管理パネルからコメント返信ができなかった不具合を修正しました。</li>
  <li>Ktai Style 1.72〜1.80 において、コメント投稿で携帯端末情報 (iモードID、EZ番号等) を必須と設定した場合、携帯端末情報が送信されなかったときのエラーが日本語化されていない不具合を修正しました。</li>
  <li>WordPress 2.8 以降において、コメントとトラックバック・ピンバックを混在表示させているとき、コメント種別がローカライズされず [Comment] と表示される不具合を修正しました。</li>
  <li>Classic テーマのコメント表を WordPress 2.7 以降の見た目を WordPress 2.6.5 以前の見た目に似せるようにしました。(従来は Default テーマのコメント表示に似てしまっていました)</li>
  <li>redir.php テンプレートの仕様を変更し、KS_ALWAYS_RELAY_PAGE を true に設定した場合、携帯サイトの URL と PC サイトの URL が違うにかかわらず「訪問先のサイトは同じ URL で携帯表示があります」という表示になる不具合を修正しました。</li>
  <li>Ktai Style 1.80 において、<code>ks_content(), ks_get_content()</code> で文字数指定したとき、「続きを読む…」ではなく単なる [...] が出力されるようにした仕様変更をやめて、Ktai Style 1.74 までの挙動に戻しました。(<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=19917">チケット#19917</a>)</li>
  <li>定数「KS_なんちゃら」の一部を「KTAI_なんちゃら」に変更しました。自作テーマに関するものは <code>KS_ALWAYS_RELAY_PAGE → KTAI_ALWAYS_RELAY_PAGE, KS_ADMIN_MODE → KTAI_ADMIN_MODE</code> のみです。</li>
</ul></dd>
<dt id="ver180">ver 1.80 (2009-12-02)</dt>
<dd><ul>
  <li>WordPress 2.5.x 系統のサポートを終了し、WordPress 2.6 以降対応としました。WordPress 2.5.x では Ktai Style 1.74 をご利用ください。</li>
  <li>iPhone, iPod touch, Android 端末でも Ktai Style による携帯表示を行えるようにしました (デフォルトでは適用されません)。</li>
  <li>ソフトバンク 3G 端末の場合、絵文字をウェブコードではなく Shift_JIS のバイナリーで表示させるようにしました。わずかながらパケット数削減となっています。</li>
  <li>caption ショートコードを使って画像を貼り込んでいる場合、もしくは img 要素の class に alignleft, alignright を使っている場合、左右の配置指定を反映して携帯でも回り込みが行なわれるようにしました。ただし、au 端末では画像の次に p 要素があれば回り込みが解除されてしまいます。</li>
  <li>ビジュアルエディターで携帯絵文字を含む投稿やコメントを編集しても壊れないようになりました。ただし、携帯絵文字そのものはビジュアルエディターでは表示されません。絵文字の修正を行うためには、HTML エディターで編集してください。</li>
  <li>フォームに <code>ks_fix_encoding_form()</code> を使用していれば、Shift_JIS → UTF-8 の変換を自動的に行うようにしました。(<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=16590">チケット#16590</a>)</li>
  <li><a href="http://contactform7.com/ja/">Contact Form 7</a> バージョン 2.0.6 以降を使っている場合、携帯電話からフォームを送信しても文字化けしないようになりました。</li>
  <li>管理機構で、携帯テーマの設定機能を廃止しました。</li>
  <li><code>ks_content()</code> で文字数指定した場合、本文中のショートコードが残らないようにしました。(<a href="http://sourceforge.jp/ticket/browse.php?group_id=2362&amp;tid=17880">チケット#17880</a>)</li>
  <li>Default 以外のテーマで、コメントとトラックバック・ピンバックを混在表示させたとき、コメント種別表示が [Comment] のように英語になってしまう問題を修正しました。</li>
  <li><code>is_ktai()</code> 関数の引数に <code>'search_engine'</code> を追加しました。モバイル検索エンジンにクロールされているとき、クローラ名になります。</li>
  <li><code>ks_term_name()</code> が au の新機種に対応しました。</li>
</ul></dd>
<dt id="ver174">ver 1.74 (2009-07-16)</dt>
<dd><ul>
  <li>WordPress 2.8 で、一部英語表示が残ってしまう不具合、およびコメント投稿時に匿名ユーザーでログイン状態になることがある不具合を修正しました。</li>
  <li>Ktai Style による警告画面 (外部サイトへのリンクを辿るとき、コメントや投稿を削除するときなど) が PHP エラーにより白紙画面になってしまう不具合を修正しました (Ktai Style 1.73 のみ発生)。</li>
  <li><code>ks_term_name()</code> が au の新機種に対応しました。</li>
</ul></dd>
<dt id="ver173">ver 1.73 (2009-06-01)</dt>
<dd><ul>
  <li>コメントフォーム、外部サイトへの中継ページ、その他警告ページは、メタタグとして <code>&lt;meta name="robots" content="noindex,nofollow" /&gt;</code> を出力するようにしました。</li>
  <li>外部サイトへのリンク時、携帯サイトの URL 検出がまれに失敗することがある現象を修正しました。</li>
  <li>WordPress アドレス (wpurl) とブログのアドレス (home url) でホスト部が異なるとき、画像の表示ができなかったり管理パネルに入れないなどの不具合を修正しました。</li>
  <li>ドコモ mova, ソフトバンク PDC で、投稿管理画面が「ページが大きすぎる」エラーを出にくくなるよう調整しました。</li>
  <li><code>ks_term_name()</code> が au の新機種に対応しました。</li>
  <li><code>ks_in_network()</code> が EZweb の IP アドレス追加に対応しました。また、iモード端末のIP帯域の誤記を修正しました。</li>
</ul></dd>
<dt id="ver172">ver 1.72 (2009-04-20)</dt>
<dd><ul>
  <li>各テーマの header.php の <code>$ks_settings['list_pages']</code> で規定しているページ一覧の表示順序を、ページタイトル順にしました (従来は ページ ID 順でした)。</li>
  <li><code>ks_pages_menu()</code>の第4引数にパラメーターを入れても認識されなかった不具合を修正しました (Ktai Style 1.71 でのバグ)。</li>
  <li><code>ks_posts_nav_multi()</code>が、最初と末尾ページへのリンクしか出なくなっていた不具合を修正しました (Ktai Style 1.71 でのバグ)。</li>
  <li>附属テーマすべてに対し、コメントのページ分割表示を設定している場合でコメントが1ページに収まるとき、余計な空行が出ないようにしました。</li>
  <li>Default テーマの header.php で <code>$ks_settings['list_pages']</code> を設定しても、footer.php でのページ一覧表示に反映されない不具合を修正しました。また、(WordPress 2.7 以降で搭載された) コメントのページ分割表示を行なっている場合、コメント番号がページをまたがって連番になるようにしました (従来は各ページで1番から始まっていました)。</li>
  <li>スタイルシートを利用した携帯テーマを使っている場合、mixi モバイルからアクセスできない現象があったのを改善しました。</li>
  <li><code>ks_comments_link()</code> で、icon 引数を <code>''</code> に設定した場合、コメントなしの場合の文字列を「0」(数字の零1文字) にしても「0」という表示ではなく、コメント数表示自体がされない不具合を修正しました。</li>
  <li>携帯テーマで font タグの開きタグと閉じタグの釣り合いが取れていない場合、不正な文字が残ってしまい、XHTML 出力が乱れることがある不具合を修正しました。</li>
</ul></dd>
<dt id="ver171">ver 1.71 (2009-03-29)</dt>
<dd><ul>
  <li>ブログで文字列検索した結果を <code>ks_posts_nav_dropdown()</code> によるポップアップ (プルダウン) 式ナビゲーションで移動したとき、検索文字列が化ける不具合を修正しました。(例えば、「携帯」で検索させて他のページに移動すると「g」という文字列による検索になってしまう)</li>
  <li>投稿者別の表示をさせたとき (URL が ?author=1 とか /author/admin/ などの場合)、タイトルに投稿者名が表示されず「による投稿」となっていた不具合を修正しました。</li>
  <li>ウィルコム絵文字の説明を公式サイトのものに準拠させました。絵文字画像がないときの代替文字も一部変更しています。</li>
  <li><code>ks_time()</code> などによる去年以前の日付表示が UTC (世界標準時) を基準にしていた不具合 (日本時間設定の場合、0時〜8時59分の投稿で日付が1日ずれる) を修正しました。(Ktai Style 1.60 以降で発生)</li>
  <li>HTML タグを含む投稿・ページの編集が正しく行えない (編集フォームが乱れてしまう) 不具合を修正しました。(Ktai Style 1.70 のみ発生)</li>
  <li>投稿一覧・ページ一覧・コメント一覧画面で、ポップアップ (プルダウン) 式のページナビゲーションを上部に設置しました。かわりに、下部にあった複数ページのナビゲーションは前後ページのナビゲーションにしました。</li>
  <li>投稿一覧・ページ一覧・コメント一覧画面で検索させたとき、ページ数を1ページ目に戻るようにしました。検索前のページ数が10ページで、検索結果が8ページしかない場合は「見つかりませんでした」になる現象が回避されます。</li>
  <li>投稿一覧から投稿ごとのコメント一覧を表示させて、さらに文字列による検索をさせたとき、投稿ごとのコメント一覧からの絞り込みにならず、全コメントからの検索になる現象を修正しました (WordPress 2.7.x のコア自体のバグ)。</li>
  <li>EZweb 端末でダッシュボードやコメント管理画面を使用したとき、「返信」リンクに不正な文字 (たいていの場合 ? 表示) が付与していた不具合を修正しました。</li>
  <li>Default, Classic テーマの「最新コメント」表示で、コメントとトラックバック・ピンバックを混在させて表示しているときでも、「コメント」「トラックバック」など種別表示をやめました。絵文字アイコンが笑顔のときはコメント、家のときはトラックバック・ピンバックで判別可能です。(他のテーマでは種別表示をしていませんので、それに揃えたものです)</li>
  <li>Green テーマの言語リソースを Ktai Style 本体に移動して、functions.php, ja.po, ja.mo を削除しました。</li>
  <li>Loving テーマで、フロントページを固定ページにして投稿ページを別に設定した場合、「サイトトップ」へのリンクが出てこない不具合を修正しました。「／」を示す言語リソースを Ktai Style 本体に移動しました。(「メニュ〜」が残っているので、言語リソース自体は存続します)</li>
  <li>Monolith テーマで、archive.php テンプレートと index.php を統合して後者のみにしました。また、言語リソースを Ktai Style 本体に移動して、functions.php, ja.po, ja.mo を削除しました。</li>
  <li>Redportal テーマで、フロントページのみに適用される home.php テンプレートを新設しました。通常の home.php は2ページ目以降も適用されますが、本 home.php は、2ページ目以降は index.php を使用するよう設定しています。また、パスワード保護された投稿でのコメント閲覧・コメント投稿で、タイトルが表示されるようにしました。</li>
  <li>HTML タグ前後の1バイトスペースは極力削除しないようにしました。従来、デザイン調整のために空白を入れても、表示時には削除されることがありました。</li>
  <li>header.php テンプレートで、menu_pages.php テンプレートおよびフッターでページ一覧を表示するときに使う <code>wp_list_pages(), ks_pages_menu()</code> に与えるオプションを <code>$ks_settings['list_pages']</code> で一括指定できるようにしました。ソート順 (<code>sort_column</code>)、除外するページ ID (<code>exclude</code>) などを指定すると便利でしょう。また、EZweb および SoftBank 3G に挿入する style 要素を CDATA セクションで囲むようにしました (XHTML 規格への準拠を向上)。</li>
  <li>comments.php テンプレートで、コメント返信用テキスト (<code>reply_text</code>) に絵文字以外の HTML を含めている場合、パスワード保護した投稿でのコメント一覧表示が不自然になる不具合を修正しました (HTML タグを除去するようにしました)。</li>
  <li><code>ks_in_network()</code> が EZweb の IP アドレス削減に対応しました。</li>
  <li><code>ks_previous_post_link(), ks_next_post_link()</code> の出力が、それぞれ previous_post_link, next_post_link フィルターを通るようにしました。</li>
  <li><code>ks_posts_nav_dropdown()</code> を改良して、14 ページ以上ある場合はすべてのページをメニューに入れずに適宜間引くようにしました。これにより、index.php テンプレート等にも <code>ks_posts_nav_dropdown()</code> によるメニューを入れるようにしました (従来は archive.php テンプレートのみ)。</li>
  <li>次のテンプレートタグの引数を、配列やクエリー文字列でも可能としました (オプションも増えています): <code>ks_pagenum(), ks_previous_post_link(), ks_next_post_link(), ks_previous_posts_link(), ks_next_posts_link(), ks_posts_nav_link(), ks_posts_navi_multi(), ks_posts_navi_dropdown(), ks_comments_post_link(), ks_back_to_post(), ks_get_recent_comments(), ks_category(), ks_tags(), ks_pages_menu()</code></li>
  <li>次のテンプレートタグを追加しました: <code>ks_post_password_required(), ks_dropdown_archives()</code></li>
</ul></dd>
<dt id="ver170">ver 1.70 (2009-02-22)</dt>
<dd><ul>
  <li>外部サイト接続確認スクリプト redir.php を、外部からの悪用ができないようにしました。また、携帯サイトが見つかったときでも、元のリンク先とホストが異なる場合は中継画面を出すようにしました。(従来は異なるホストでも自動的にリダイレクトしていました) <strong>*** これはセキュリティー修正です***</strong></li>
  <li>WordPress 2.3.3 以前をサポート対象から外しました。動作するかもしれませんが、できれば Ktai Style 1.48 をご利用ください。EUC-JP の言語リソースの添付も中止しました。(UTF-8 の po ファイルから簡単に生成できます)</li>
  <li>ニンテンドー Wii および DSi でも携帯表示になるようにしました。</li>
  <li>WordPress 2.7 以降で個別のコメントに返信するときは、コメントフォームの上に、親コメントの内容を表示するようにしました。</li>
  <li>携帯電話表示では <a href="http://wordpress.org/extend/plugins/disqus-comment-system/">DISQUS Comment System プラグイン</a>を抑制するようにしました。</li>
  <li>WP Super Cache 0.6.8 以降の場合、手動で .htaccess を書換えなくて済むようにしました。</li>
  <li>WordPress 2.7 で、コメント投稿時に端末識別情報を必須としているものの、端末識別情報が取得できなかった場合に、PHP のエラーが出るもしくは反応がない不具合を修正しました。</li>
  <li>Flickr 画像が medium サイズ以外のとき、うまく表示されない不具合を修正しました。</li>
  <li>Compact テーマは Default テーマに統合しました (ただし、home.php を削除すれば Compact テーマ同等になります)。新たに、Green, Loving, Monolith の3テーマを添付しました。</li>
  <li>Redportal テーマの多言語化が不十分だったのを修正しました。また、「前の NN 件」「次の NN 件」の言語リソースを Ktai Style 本体に移動しました。他のテーマでもこのローカライズ文字列が使えるようになります。</li>
  <li>すべてのテーマで、フロントページを固定ページ (静的ページ) に設定しているとき、ブログページ (最新の投稿) へのリンクをフッター部分に追加するようにしました。</li>
  <li>?menu=links の URL および <code>ks_list_bookmarks()</code> で表示できるブログロール (リンク集) について、i-mode, EZweb, Yahoo! ケータイ、ディズニー・モバイルの場合、中継ページ経由のリンクになるようにしました (従来はすべて直接リンクになっていました)。</li>
  <li>管理パネル (ダッシュボード／コメント一覧) から、コメント返信できるようになりました。</li>
  <li>管理パネルの投稿一覧・ページ一覧に、それぞれの投稿についたコメントの一覧を見られるリンクを付与しました。</li>
  <li>投稿やページの本文で2行目以降の行頭にスラッシュ(/)がある場合、携帯閲覧時や携帯での投稿・ページ編集時に行頭のスラッシュが欠落してしまう不具合を修正しました。</li>
  <li>年別アーカイブ用のメニュー (menu_years.php) を追加しました。ここで年を選ぶと、その年の月別アーカイブが表示されます。</li>
  <li>すべてのテーマで、下矢印を示すローカライズ文字列を &amp;darr; に変更しました (従来は「v」という文字を下矢印にしていました)。また、functions.php にあったコメント関連の関数を comments.php に移動しました。</li>
  <li>iモード端末の場合、big, small 要素が無効のため font size 要素もしくは span style="font-size:bigger/smaller" に書換えるようにしました。逆に、EZweb 端末の場合、font size="+1", font size="-1" が効かないため、big, small 要素に書き換えるようにしました。</li>
  <li><code>ks_use_appl_xhtml()</code> テンプレートタグによる、HTML からインラインスタイルシートへの変換機能の精度を向上させました。font 要素が入れ子になっていても正常に動作するなどの改良が行なわれています。(Green, Loving, Monolith テーマが対象)</li>
  <li>携帯向けページ分割位置を示す start paging, end paging にパラメータを与えれば、分割時の罫線 (&lt;hr /&gt;) をカスタマイズできるようにしました。</li>
  <li><code>ks_term_name()</code> が au の新機種に対応しました。</li>
  <li><code>ks_in_network()</code> がウィルコムの IP アドレス削減に対応しました。</li>
  <li><code>ks_comments_link()</code> で、コメント数を示すパラメーターが空文字列のとき、コメント数表示自体をしないようにしました。つまり、コメントがあるときのみコメント数を表示する／コメント停止中のときはその表示自体を隠すようなデザインが可能になります。</li>
  <li><code>ks_comments_link(), ks_comments_post_link(), ks_back_to_post()</code> でリンク用文字列を内部で HTML エスエープするのをやめました。このため、HTML を渡すとそのまま表示されます。適宜、テンプレート側で <code>wp_specialchars()</code> などを使って HTML エスケープしておいてください。</li>
  <li><code>ks_switch_pc_view(), ks_switch_inline_images()</code> のリンク色を指定できるようにしました。文字の背景色を暗い色にしている場合、リンク色を明るい色に変更して見やすくできます。</li>
  <li>次のテンプレートタグを廃止しました: <code>ks_get_ordered_link()</code> (<code>ks_ordered_link()</code> で代替できるようにしました)。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_ext_css_available(), ks_page_title(), ks_excerpt(), ks_cut_html(), ks_dropdown_categories(), ks_get_admin_user()</code></li>
  <li>次のテンプレートタグの引数を、配列やクエリー文字列でも可能としました (オプションも増えています): <code>ks_content(), ks_login_link(), ks_ordered_link(), ks_comments_link(), ks_switch_pc_view(), ks_switch_inline_images()</code></li>
   <li>external_link フィルターフック用に <code>$icon</code> 引数 (外部サイトを示す絵文字アイコン) を追加しました。絵文字の変更や除去に使えます。</li>
  <li>split_page_navi フィルターは、<code>sprint()</code> 用のフォーマット文字列ではなく <code>sprint()</code> フォーマットした後の HTML 文字列を渡すようにしました。</li>
  <li>次の独自フィルターフックフィルターフックを追加しました: <code>redir_error</code></li>
</ul></dd>
<dt id="ver160">ver 1.60 (2009-01-22)</dt>
<dd>(ver 1.47 からの変更点です。1.48 以降は別ブランチ版となりました)<ul>
  <li>画像をインライン表示しているとき、元画像のサイズが 50KB 以下ならば元画像へのリンクを携帯用サムネール画像に直接付与するようにしました。それ以上のサイズの場合は、従来通り、画像の後ろに「元画像 (xxxKB)」というテキストリンクになります。</li>
  <li>Flickr の画像はサムネールサイズ (75x100 または 100x75) の画像をインライン表示するようにしました。(すべての画像がリンクになる mova, ソフトバンク PDC を除く)</li>
  <li>ドコモ FOMA, EZweb, ソフトバンク 3G での1ページ当たりの HTML サイズを約20KBに増量しました。分割せずに見られる範囲が広がっています。</li>
  <li>「携帯表示」の日時指定の仕様を変更し、「去年以前の日時」「今年の日時」で時刻部分を含めた書式を指定することにしました。これにより、「年月日を表示するときは時刻を省略する」といったカスタマイズが可能です。</li>
  <li>最新コメントの表示で、投稿者やピン送信元サイト名と、日時の表示を入れ替えて、日時の方に各コメントへのリンクを張るようにしました。</li>
  <li>ログインせずゲストとしてコメント投稿したとき、クッキー対応の携帯電話の場合は、端末のクッキーに名前・メールアドレス・ウェブURLを保存するようにしました。</li>
  <li>コメント投稿した後、投稿ページではなくコメント一覧表示に移動するようにしました。</li>
  <li>WordPress 2.7 で導入された、コメント表示の入れ子表示・ページ分割に対応しました。</li>
  <li>パスワード保護された投稿に付く絵文字を鍵マークに、非公開投稿に付く絵文字をマル秘にしました (従来は逆になっていました)。</li>
  <li>Redportal テーマで、コメントの並び順を最新順／古い順で切り替えできるようにしました。また、「携帯表示」環境設定におけるコメントとトラックバック・ピンバックを混在する設定を反映するようにしました。さらに、コメント・また、EUC-JP 環境でも文字化けせず表示できるようになりました。</li>
  <li>アメーバブログは、携帯電話の実機からは PC 向けアドレスでの閲覧で携帯向け表示に対応していたため、中継ページを出さないように修正しました。</li>
  <li>外部サイト接続確認ページを、redir.php というテンプレートで記述できるようにしました。従来は redir 独自フィルターフックを使って表示内容を書き換え可能でしたが、より柔軟なカスタマイズが可能です。</li>
  <li>サーバー自体のタイムゾーン設定と、WordPress の一般設定で指定したタイムゾーンが一致していない場合に、今年かどうか、今日かどうかの判断がおかしかった不具合を修正しました (昨日の日時なのに時刻だけ表示してしまった etc)。</li>
  <li>WordPress 2.6 以降で、wp-content ディレクトリーもしくは plugins ディレクトリーを標準の位置以外に移動している場合、ktai_style ディレクトリーに書き込み権限を与えておけば、プラグインの有効化時に、自動的に移設場所を検知するようになりました。</li>
  <li>WordPress 2.7 において、携帯管理画面で英語表示が残っていたのを修正しました。</li>
  <li>管理機能を一新しました。<ul>
    <li>利用できる WordPress バージョンを 2.5 以降としました。2.3.x 以前では管理機能が使えなくなりました。</li>
    <li>投稿の公開ステータスを変更できるようにしました。</li>
    <li>投稿者権限のユーザーが投稿作成したとき「レビュー待ちとして送信」ができるようにしました。</li>
    <li>ページ編集・ページ作成に対応しました。</li>
    <li>コメントの一括操作 (一括承認や一括削除など) をできるようにしました。</li>
    <li>コメントの種類 (コメント／トラックバックとピンバック) で仕分けできるようにしました。</li>
    <li>スパムに判定されたコメントを一覧できるようにしました。</li>
  </ul></li>
  <li>次の独自フィルターフックを追加しました: <code>thumbnail_max_size, direct_link_image_size, mobile_search_ip</code></li>
  <li>次のテンプレートタグを追加しました: <code>ks_cookie_available(), ks_get_time(), ks_get_mod_time(), ks_get_comment_datetime(), ks_get_ordered_link(), ks_get_comment_link(), ks_separate_comments()</code></li>
</ul></dd>
<dt id="ver14xbranch">ver 1.48</dt>
<dd>(ver 1.48〜1.59 は別ブランチとなりました。変更点は 1.4x 系のパッケージ同梱の改版履歴を参照してください)</dd>
<dt id="ver147">ver 1.47 (2009-01-07)</dt>
<dd><ul>
  <li>classic テーマに存在したセキュリティーホールを修正しました。</li>
  <li>EZweb の新しい IP アドレス帯域に対応しました。</li>
  <li>最新コメント一覧で、下書き／レビュー済み／非公開の投稿・ページに対して付与されたコメントを除外するようにしました (従来はリストされてしまっていました)。</li>
  <li>ドコモ mova, ソフトバンク PDC において、本来出ないはずの「画像:表示する | リンクに変換」の切り替えメニューが出る不具合を修正しました (Ktai Style 1.44 からエンバグ)。</li>
  <li>イー・モバイル音声端末用の個別テーマを PC 向け管理パネルで選択しても反映されない不具合を修正しました。</li>
  <li>管理機能の投稿一覧で、投稿者での絞り込みが動作していなかった不具合を修正しました。</li>
  <li>携帯電話で新規投稿したとき、wp_posts テーブルの guid フィールドが、スラッシュ (/) で始まるパス文字列になっていた不具合を改善しました。(パーマリンクの URI 形式で格納)</li>
  <li>次のテンプレートタグを標準搭載しました: <code>ks_convert_kana()</code></li>
</ul></dd>
<dt id="ver146">ver 1.46 (2008-12-12)</dt>
<dd><ul>
  <li>mixi モバイルからのアクセス時に携帯向けページを表示するようにしました。</li>
  <li>PHP に mbstring 拡張が組み込まれていない場合でも、プラグイン有効化時などにエラーが発生しないようにしました。</li>
  <li>Ktai Style 1.45 にて、複数ページの切り替えメニュー (<code>ks_posts_nav_dropdown()</code>) が正常に機能しないバグを修正しました。</li>
</ul></dd>
<dt id="ver145">ver 1.45 (2008-11-08)</dt>
<dd><ul>
  <li>ドコモ端末で PNG 画像を GIF 画像に変換する機能、および、ソフトバンク PDC 端末で GIF 画像を PNG 画像に変換する機能が動作しない場合があったのを改善しました。</li>
  <li>リッチエディット画面で入れた空白 (U+00A0 の空白) が、携帯電話表示では ? になってしまうのを、通常の空白に変換させるようにしました。</li>
  <li>ウェブログの文字コードが UTF-8 以外 (EUC-JP 等) の場合、<code>&amp;laquo;, &amp;raquo;</code> という実体参照が文字化けする可能性があったのを修正しました。</li>
  <li>WordPress 2.0.x の場合、<code>ks_posts_nav_link()</code> による前後ページへのリンクが出力されていない不具合があったのを修正しました。</li>
  <li>PHP 5.0.x 系統の場合、ソフトバンク端末で閲覧時に PHP エラーが発生して表示できない不具合があったのを改善しました。</li>
  <li>au の冬モデルのデバイス ID 、およびウィルコムに追加された IP アドレス帯域に対応しました。</li>
  <li>携帯対応ブログとして、au one ブログ(http://blog.auone.jp/service/)、ぷららブローチ (http://pub.ne.jp/) を追加しました。</li>
  <li>Ktai Location が処理した位置情報 URL を携帯電話で非表示にする処理で、HTML 文法違反が発生することがある現象を修正しました。</li>
</ul></dd>
<dt id="ver144">ver 1.44 (2008-09-20)</dt>
<dd><ul>
  <li>EMOBILE H11HW, SONY mylo で閲覧したとき携帯向け表示をさせるようにしました (H11HW については、実機テストをしていません)。</li>
  <li>最新コメント一覧 (テンプレート menu_comments.php を使用した出力) を、端末のキャッシュに残さないようにしました (au 端末はキャッシュに残ってしまい、ページ更新しない限り最新情報ではありませんでした)。</li>
  <li>携帯対応ブログとして teacup.ブログ Auto Page (http://autopage.teacup.com/) を追加しました。</li>
  <li>外部サイトへのリンクをクリックしたとき、携帯サイトが存在するかの確認 (Mobile Link Discovery の検出) でタイムアウトしたり白紙画面になったりすることがある事象を改善しました。また、外部サイトの URI にポート番号を含む場合 (http://blog.example.jp:10080/ のような場合) に携帯サイトの検出ができるよう改善しました。</li>
  <li>a 要素で class="pconly" というクラス指定をした場合、または、shrinkage.php の <code>$none_mobile_url</code> および none_mobile_url フィルターで追加したサイトに対しては、Mobile Link Discovery の検出をせずにすぐ中継ページを出すようにしました。</li>
  <li>スマートフォン等 (「その他」端末) において、「PC 表示にする」リンクをクリックして PC 表示に切り替えた場合、テーマによっては「携帯表示にする」の背景色であるグレーが背景全体に広がってしまうことがある現象を回避するようにしました。</li>
  <li>WordPress MU において、画像が表示されない／リンクにならない／wp-signup.php を実行したときに PHP エラーが発生するなどの不具合を改善しました。(注意: WordPress MU での動作を保証したわけではありません)</li>
  <li>au の絵文字と他機種絵文字の対応を一部変更しました。</li>
  <li>au およびイー・モバイルの新機種について、<code>ks_term_name()</code> による機種名抽出に対応しました。</li>
  <li>iモード用に追加される予定の IP アドレス帯域に対応しました。</li>
  <li>テンプレートタグ <code>ks_is_menu()</code> にオプションの引数を追加しました。</li>
  <li>次の独自フィルターフックを追加しました: ks_login_logo, switch_ktai_view_css, switch_ktai_view</li>
</ul></dd>
<dt id="ver143">ver 1.43 (2008-07-21)</dt>
<dd><ul>
  <li>span 要素, div 要素の stye 属性 (ビジュアルエディタで付けた文字色などが使用) は携帯出力で削除せずそのまま出力するようにしました。</li>
  <li>WordPress 2.6 以降で、wp-content/ ディレクトリーもしくは wp-content/plugins/ ディレクトリーを移設した場合に対応しました。ktai_style/wp-load.php の書き換えが必要です。</li>
  <li>Default テーマなど、本文を途中で切る処理 (テンプレートタグ <code>ks_get_content()</code> で可能) が XHTML 文法違反になることがある事例を修正しました。</li>
  <li>複数プラグインをまとめて使用・停止したとき、携帯ログイン用セッション保存テーブルの生成や削除に失敗する不具合を修正しました。また、WordPress 2.1 以前では管理機能が使えないため、セッション保存テーブルを作成しないようにしました。</li>
  <li>ktai_style フォルダー／ディレクトリーの名前を変更している場合、プラグインを使用停止したとき携帯ログイン用セッション保存テーブルが削除されない不具合を修正しました。</li>
  <li><code>is_ktai()</code> 関数の引数に 'flat_rate' を与える定額パケット通信に対応しているかどうかを返す機能が正常に働いていなかった不具合を修正しました。</li>
</ul></dd>
<dt id="ver142">ver 1.42 (2008-07-10)</dt>
<dd><ul>
  <li>a 要素に href 属性がない場合はリンクとみなさないようにしました (従来は &lt;a name="foo"&gt;&lt;/a&gt; のような場合も外部リンクとして中継ページを出してしまっていました)。</li>
  <li>リンク先に Mobile Link Discovery があるかの確認で、モバイル版ページの URL を確実にできるよう改善しました。(Ktai Style 1.41 でも抽出できない場合があったので、さらに改良)</li>
  <li><code>is_ktai()</code> 関数の引数に 'flat_rate' を与えると、定額パケット通信に対応しているかどうかを返すようにしました (<code>ks_is_flat_rate()</code> と同じ返り値)。</li>
  <li>wp-content/ktai-themes/ ディレクトリーに格納したテーマを設定できない不具合を修正しました。(Ktai Style 1.41 で発生したバグ)</li>
  <li>画像のファイル名が thumbnail.jpg や 160x120.png のような形式 *ではない* 場合 (image.jpg, sample.gif など)、携帯電話向けサムネール (最大96ピクセル) を作らずそのまま表示していた不具合を改善しました (Ktai Style 1.41 で発生したバグ)。</li> 
  <li>コメント時にログインしたとき、コメント投稿後、「cannot redeclare class...」のエラー (クラスの重複定義エラー) が出ることがある不具合を修正しました。</li>
</ul></dd>
<dt id="ver141">ver 1.41 (2008-07-06)</dt>
<dd><ul>
  <li>PHP 5.0, 5.1 でも動くように調整しました。ただし、PHP 5.0.x, 5.1.x でのテストは行なっていません。動かない場合はあきらめてください;-)</li>
  <li>WordPress 2.6 ベータ版への対応を盛り込みました。</li>
  <li>Compact テーマのフッターで、固定ページへのリンクメニューをやめて、固定ページ一覧ページへのリンクとしました (Redportal メニューと同じ表示)。</li>
  <li>各社スマートフォンなど「その他」端末での絵文字画像に style="border:0 none;" 属性を付与しました。絵文字が a 要素に含まれるとき、絵文字画像に枠がつかないようになります。</li>
  <li>PC やスマートフォンにおいて、より多くの絵文字が画像表示できるよう、絵文字と画像の対応を調整しました (画像自体は増えていません)。</li>
  <li>中継ページを出さずに直接リンクするウェブサイトに「楽天アフィリエイト」を追加しました。</li>
  <li>新規投稿および投稿編集で投稿スラッグが入力・編集できるようになりました。</li>
  <li>WordPress 2.3 以降では、ダッシュボードに下書きの件数を表示し、また、投稿管理画面で公開ステータス (投稿ステータス) での絞り込みができるようになりました。WordPress 2.2 では、投稿一覧の上部に、自分の草稿に加えて他人の草稿も表示するようにしました。</li>
  <li>ktai_style/admin/ 配下の管理機能に直接アクセスしてログイン画面にリダイレクトされたとき、ログイン後にアクセスしようとした管理画面にジャンプするようにしました。(PC の管理機能と同じ動作)</li>
  <li>下書き投稿は作成日時を 0000-00-00 00:00:00 となるようにしました。(PC での下書き作成と同じ動作)</li>
  <li>au の機種判別で、7月に発売する新機種に対応しました。</li>
  <li>携帯向けサムネールを作らないぐらい小さい画像 (長辺が 96 ピクセル以下) が表示されない不具合を修正しました (Ktai Style 1.35 以後発生していたバグ)。</li>
  <li>PNG, GIF 画像をインライン表示ではなくリンクに変換している場合 (mova, ソフトバンク PDC 等) において、PC 向けサムネールまたは中サイズ画像へのリンクが見つからない (Not Found) になっていた不具合を修正しました。</li>
  <li>Palm OS ハンドヘルド、シャープ Zaurus で閲覧したとき、WP-Cache 等キャッシュプラグインに携帯表示がキャッシュされてしまう不具合を修正しました。</li>
  <li>リンク先に Mobile Link Discovery があるかの確認で、相手先サーバーがチェンク形式のデーター (Transfer-Encoding: chunked) を返したときに、モバイル版ページの URL をうまく抽出できないことがあった不具合を修正しました。</li>
  <li>leave_scheme, mobile_same_url, none_mobile_url フィルターフックを使うためのフィルター関数を、携帯テーマの functions.php に書いても呼び出されるようにしました。(従来は、フィルター関数を my-hacks.php に書く必要がありました)</li>
  <li>作者権限ではコメントを編集できないことがある不具合を修正しました。</li>
  <li>プロフィール編集で日本語ニックネームを入力しても空白になってしまう不具合を修正しました。また、WordPress 2.5 以降で、メッセージが英語の「Profile Updated.」になっていたのを日本語メッセージになるように調整しました。</li>
  <li>Ktai_Style::request_path() メソッドを廃止しました。代わりに <code>$_SERVER['REQEUST_URI']</code> を使用してください。</li>
  <li>独自テンプレートタグ <code>ks_get_wp_version()</code> を廃止して <code>ks_check_wp_version()</code> を新設しました。</li>
</ul></dd>
<dt id="ver140">ver 1.40 (2008-06-18)</dt>
<dd><ul>
  <li>Palm OS ハンドヘルド、シャープ Zaurus も携帯表示をさせるようにしました。</li>
  <li>スマートフォン等の「その他」端末では、プラグイン画像をそのまま表示させるようにしました。例えば、FireStats の国旗・OS・ブラウザーアイコンが、プラグイン組み込みのものがそのまま出ます。</li>
  <li>ウィルコム、イー・モバイル、スマートフォン等の「その他」端末では、外部サイトへのリンクにアイコンをつけるのをやめました。もともと直接リンクしており、アイコンをつける意味はありませんでした。</li>
  <li>PC やスマートフォンでも絵文字が画像で表示されるようにしました。今のところ、iモード絵文字のみすべて画像で出ます。それ以外の絵文字は順次対応する予定です。</li>
  <li>外部サイトへの中継ページを出す直前で相手先にアクセスして <a href="http://www.sixapart.jp/docs/tech/mobile_link_discovery_ja.html">Mobile Link Discovery</a> を確認し、携帯ページを発見すれば直接リンクするようになりました。このため「PC向け」の表示を「外部サイト」に変更しました。</li>
  <li>RSS2 フィードにも Mobile Link Discovery を出力するようにしました。</li>
  <li>「携帯表示」設定画面のテーマ一覧で、style.css に記載されたテーマ名称およびバージョンを表示させるようにしました。従来はテーマのフォルダー (ディレクトリー) 名を出していました。</li>
  <li>コメントへの絵文字使用を認めない場合、ソフトバンク絵文字がウェブコードのまま残っていましたが、積極的に除去するようにしました。</li>
  <li>投稿管理およびコメント管理で、ページナビゲーションをリストの下に移動しました。</li>
  <li><code>in_network()</code> メソッドをウィルコムの IP アドレス帯域追加に対応させました。</li>
  <li>言語リソースを lang フォルダーに、電話キャリアー用ライブラリーを operators ディレクトリーに移動しました。</li>
  <li>附属テーマの PHP, XHTML の記述を見やすいよう改善しました。テーマの見栄えは従来と同じです。</li>
  <li>Windows サーバーで運営していて、かつ、プラグインのフォルダー名を ktai_style 以外に変更しているとき、正常に動作しない不具合を修正しました。</li>
  <li>GD が組み込まれていない PHP で稼動させたときでも異常終了しないようにしました。</li>
  <li><code>comment_form</code> アクションを利用してコメント投稿フォームにフィールドを追加するプラグインが正常に動作しない不具合を修正しました。</li>
</ul></dd>
<dt id="ver136">ver 1.36 (2008-06-09)</dt>
<dd><ul>
  <li>Ktai Style 1.35 で、携帯からコメントすると白紙画面もしくは PHP エラー画面になってしまう不具合を修正しました (Ktai Style 1.35 のみ存在するバグ)。</li>
  <li>Ktai Style 1.35 で、画像をインライン表示させているとき、<code>imagecreatefromjpeg()</code> 関数などが存在しないサーバーでは、投稿がうまく表示されないことがある不具合を修正しました (Ktai Style 1.35 のみ存在する不具合)。</li>
  <li>WordPress 2.3 以降でパーマリンク設定をしている場合、クエリー文字列つき URL でアクセスしたとき、本来の URL (パーマリンクを使った URL) へのリダイレクトが不正になる不具合を修正しました。例えば、PC では、http://example.jp/?cat=3 にアクセスすると http://example.jp/category/living/ にリダイレクトされる場合、携帯では http://example.jp/://example.jp/category/living/ という不正な URL にジャンプしていました。</li>
  <li>作成者権限しかないユーザーがコメント編集した場合、絵文字要素 (&lt;img localsrc="NNN" /&gt; フォーマットの XHTML タグ) が消えてしまう不具合を修正しました。</li>
</ul></dd>
<dt id="ver135">ver 1.35 (2008-06-06)</dt>
<dd><ul>
  <li><a href="http://mnm.uib.es/gallir/wp-cache-2/">WP-Cache 2.0</a> および <a href="http://ocaoimh.ie/wp-super-cache/">WP Super Cache</a> と併用しても問題なく動作するように、アドオンファイル patch-wpcache.php を添付しました。</li>
  <li>au の機種判別で、6月に発売する新機種に対応しました。</li>
  <li>img 要素に alt 属性がないときに画像が表示されない不具合を修正しました。(Ktai Style 1.33, 1.34 で発生したバグ)</li>
  <li>BMP 画像など、GIF, PNG, JPEG 以外の画像を表示させようとしたとき、PHP エラーが出てしまう問題を修正しました。</li>
  <li>コメント投稿時エラーをインライン表示させているとき (附属テーマの classic, default, redportal の場合など)、エラー発生時に、入力内容にあるシングルクォート(')やダブルクォート(")の前にバックスラッシュ(\)がついてしまう不具合を修正しました。</li>
  <li>作成者権限しかないユーザーが、PC で絵文字を含む投稿を編集すると、img 要素が壊れてしまう不具合を修正しました。</li>
  <li>新規投稿・投稿編集で、カテゴリー選択画面に遷移して元の画面に戻ったとき、タグフィールドの内容が保存されない不具合を修正しました。</li>
  <li>EUC-JP なウェブログで default, classic テーマを使った場合に文字化けする可能性があったのを改善しました (それぞれ index.php を修正)。</li>
</ul></dd>
<dt id="ver134">ver 1.34 (2008-05-07)</dt>
<dd><ul>
  <li>WordPress 2.3.3 以前において「絵文字投稿を許可する」設定にした場合、投稿本文にシングルクォート (') を含む場合に、投稿編集に失敗する不具合を修正しました。<strong>*** これは Ktai Style 1.20 〜 1.33 に存在するセキュリティー欠陥です ***</strong></li>
  <li>WordPress 2.5 以降において、「絵文字投稿を許可する」設定でコメント編集をするとシングルクォート (') の前にバックスラッシュ (\) がついてしまう不具合を修正しました。</li>
  <li>ウィルコム絵文字で 0xF052 は「バイク」が正当なため、変換テーブル等を修正しました (従来は「船」だと思っていました)。</li>
  <li>Nokia 端末の判別で取りこぼしがあったのを修正しました (ソフトバンク X02NK など対応)。</li>
  <li>投稿一覧で、ワード検索が正常に動作していなかった不具合を修正しました (Ktai Style 1.30 でエンバグ)。</li>
  <li>テンプレートタグ <code>ks_mb_get_form()</code> において、絵文字投稿の設定によってエスケープを外す／外さないの違いがあった問題を修正しました (エスケープありのままとしました)。</li>
</ul></dd>
<dt id="ver133">ver 1.33 (2008-04-28)</dt>
<dd><ul>
  <li>WordPress 2.5 以降のメディア管理で挿入した画像の場合、alt 属性が空でも画像を表示させるようにしました (class 属性に wp-image-NNN が含まれるかどうかで判断)。</li>
  <li><a href="http://wp.uberdose.com/2007/03/24/all-in-one-seo-pack/">All in One SEO Pack</a> を使っていると、携帯閲覧時、「白紙ページ」になったり title 要素が文字化けしたりする現象を回避するようにしました。</li>
  <li><a href="http://wppluginsj.sourceforge.jp/ktai_entry/">Ktai Entry</a> によるメール投稿の新着確認をできるようにしました。</li>
  <li>WordPress 2.5.1 で、携帯電話からの新規投稿・投稿編集で画面が途中で切れたり画面が白紙になる現象を修正しました。</li>
  <li>附属テーマの classic, default, redportal は、PlayStation Portable (PSP) で閲覧したときに画面が真っ黒になる不具合があったのを修正しました (バージョン 0.98 で複数テーマが切り替え可能になったときより発生していいました)。</li>
</ul></dd>
<dt id="ver132">ver 1.32 (2008-04-17)</dt>
<dd><ul>
  <li><a href="http://firestats.cc/">FireStats</a> がコメント投稿者の国旗アイコンを追加した場合、可能ならば携帯絵文字の国旗に変換するようにしました (日本、アメリカ、スペイン、ロシア、フランス、ドイツ、イタリア、イギリス、中国、韓国)。</li>
  <li>プラグイン用画像をリンクにせず alt 文字列をそのまま表示する処理は、コメント一覧にも適用するようにしました。</li>
  <li>Ktai Style 1.31 で作り込んでしまった、携帯向けページ分割が正常動作していない不具合を解消しました。</li>
</ul></dd>
<dt id="ver131">ver 1.31 (2008-04-15)</dt>
<dd><ul>
  <li>コメント一覧画面で、コメント投稿者の名前からサイト URL にリンク、もしくはトラックバック・ピンバック元サイト名からサイト URL にリンクするようにしました (従来はリンクせず名前だけ表示していました)。</li>
  <li>コメント編集画面で、端末識別番号を要求したときに取得した端末番号・USIM 番号や契約者IDが見られるようにしました (PC 向け管理パネルでは WordPress 2.5 以降に対応、携帯管理画面では WordPress 2.2 以降対応)。</li>
  <li>モードID通知をオフにしている端末に対しては、端末製造番号を要求するようにしました。</li>
  <li>権限が作者 (Author) 以下のユーザーで携帯絵文字を使って投稿しても絵文字が出ない問題、および下書きを編集すると「レビュー待ち」になってしまう問題を修正しました。</li>
  <li>本文の末尾に &lt;br&gt; のような、開き要素に見える HTML 要素がある場合、空の分割ページができてしまう問題を修正しました。</li>
  <li>img 要素の alt 要素などで、特定の文字 (「キ」や「業」など) が破壊されてしまう不具合への対応として、<a href="http://trac.wordpress.org/attachment/ticket/5917/kses_bad_protocol.diff">WordPress本家の trac #5917 に対するパッチ</a>を適用したものに変更しました (従来は単純に 0xad を除去する処理を削除しただけだった)。</li>
  <li>ウェブログの文字コードが UTF-8 以外の場合、PC から携帯絵文字を含む投稿・コメントを見たときに文字化けする不具合を修正しました。</li>
  <li>SoftBank 6-3 シリーズにおいて、見出し要素 (h1 - h6) を div 要素と p 要素の組に変換させるようにしました。(div 要素だけだと前の要素との間に空行がなく、p 要素だけでは align 要素が無効なため)</li>
  <li>「携帯表示」設定画面に「TU-KA」の記述があったのを削除しました (サービス終了したため)。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_comment_author_link()</code></li>
</ul></dd>
<dt id="ver130">ver 1.30 (2008-04-08)</dt>
<dd><ul>
  <li>WordPress 2.5 正式版およびイー・モバイル音声端末での動作を確認しました。WordPress 2.5 正式版では以下の改善を行なっています。<ul>
    <li>携帯管理画面の「投稿管理」で投稿一覧が出ないことがある問題を修正しました。</li>
    <li>従来は、WordPress 2.5 のサムネームを元画像と誤認して、そこから小型サムネールを作っていたのを、元画像を正しく探索してサムネールを作れるようにしました。</li>
    <li>gallery ショートコードを使った場合、本文に埋め込まれたスタイルシートを削除するようにしました (ドコモ端末ではスタイルシートの記述が見えてしまうため)。</li>
</ul></li>
  <li>WordPress 2.0.x, 2.1.x にも対応しました。ただし閲覧機能のみ対応で、管理機能は使えません。</li>
  <li>PC 版ページの URL に携帯電話でアクセスするとモバイル版ページが出るブログサービスへのリンクは、中継ページを出さずに直接ジャンプするようにしました。</li>
  <li>外部サイトのリンクで、a 要素に class="ktai" を追加した場合、中継ページを出さずに直接ジャンプするようにしました。リンク先 URL が同一 URL で PC／携帯両対応しているサイトの場合に指定すると便利です。</li>
  <li>他のプラグインが本文に挿入したスタイルシートや JavaScript を削除するようにしました。</li>
  <li>コメント時に端末識別情報を必須にしている場合、mova, FOMA では iモード ID を取得するようにしました (従来は端末 ID, UIM ID を取得していた)。このため、「携帯電話情報を送信しますか」のダイアログが出なくなりました。</li>
  <li>コメント投稿時に端末識別情報を必須とする対象に、イー・モバイル音声端末 (EMnet 経由接続の場合) を加えました。</li>
  <li>compact, default テーマで、コメント表示時の「コメント投稿」のリンクを、コメントの先頭ではなくコメント末尾の下に移動しました。</li>
  <li>管理画面の「投稿管理」で、年月を指定して絞り込みできるようにしました。</li>
  <li>自作の携帯テーマファイルは wp-content/ktai-themes/ ディレクトリー配下に入れられるようにしました。ktai_style ディレクトリーの外側のため、プラグインのアップグレードが容易になります。従来通り、wp-content/plugins/ktai_style/themes/ ディレクトリーに入れても構いませんが、今後は ktai-themes ディレクトリーが推奨です。</li>
  <li>自作テーマで、独自の menu_XXX.php ファイルを作った場合、?menu=XXX で呼び出せるようにしました。PC 向けテーマではサイドバーに入れているものを、携帯版では独立したページに切り出して提供するなどの構成が可能です。</li>
  <li><code>ks_pages_menu()</code> の第4引数で、リストアップするページの表示条件を指定できるようにしました。また、デフォルトで親ページ (第1階層のページ) のみリストアップするようにしました。</li>
  <li>携帯キャリアのIPアドレス帯域からアクセスしているかの判別をできるようにしました (<code>ks_in_network()</code>テンプレートタグ)。</li>
  <li>iモードIDを取得できるようにしました (<code>$Ktai_Style->get('sub_ID')</code>)。そのかわり、FOMA の term_ID を、端末 ID と UIM ID をコンマ (,) でくっつけた形に変更しました (従来は UIM ID を sub_ID に入れていました)。</li>
  <li>S11HT, F1100 でアクセス時、<code>ks_term_name()</code> で機種名がうまく得られない問題を修正しました。</li>
  <li>TU-KA のサービス終了に伴ない、TU-KA のデバイス ID／機種名対応テーブルを削除しました。</li>
  <li>画像をインライン表示させるとき、パーミッションがない等で小型サムネールが作れないときでも、PHP のエラーを表示させずに処理するようにしました。</li>
  <li>投稿スラッグを変更したとき、古い投稿スラッグによる URL へのアクセスを新しいパーマリンクにリダイレクトする WordPress の機能が、携帯電話では効かなかった (投稿が見つかりませんになる) 問題を修正しました。</li>
  <li>次の独自フックを追加しました: <code>init_pc, init_mobile, ks_die_logo, mobile_same_url, no_mobile_url, split_page_navi, switch_pc_view, switch_inline_images</code></li>
  <li>次のテンプレートタグを追加しました: <code>ks_in_network(), ks_do_comment_form_action(), ks_wp_head(), ks_wp_footer()</code></li>
</ul></dd>
<dt id="ver121">ver 1.21 (2008-03-18)</dt>
<dd><ul>
  <li>携帯絵文字の入力で、ソフトバンク 3G 端末からの入力にも対応しました。ver 1.20 は対応しておらず、?? のように文字化けしてしまっていました。</li>
  <li>外部サイトの画像を img 要素で呼び出している場合にも「画像を表示／リンクに変換」のメニューが出てしまっていたのを、出ないように抑制しました。(外部サイトの画像は必ずリンクになるため、切り替えメニューは意味がないのに、出てしまっていました)</li>
  <li>イー・モバイル音声端末において、HTTP ヘッダの x-em-uid フィールドから契約者 ID (ユーザー ID) の取得を試みるようにしました。</li>
</ul></dd>
<dt id="ver120">ver 1.20 (2008-03-14)</dt>
<dd><ul>
  <li>WordPress 2.5 への対応を盛り込みました (正式版での確認はまだです)。<ul>
  <li>Ktai Style バージョン 1.11 以前では、管理機能で不具合が出ますが、それを解消しています。</li>
  <li>「携帯表示」設定ページを WordPress 2.5 の管理パネルデザインに合うようにしました (2.3 以前では、ほぼ表示は同じです)。</li>
  <li>WordPress 2.5 では携帯ログイン画面のデザインを PC 版に似せて淡い色にしました (2.3 以前では、従来通りのデザインです)。</li> 
  <li>携帯版ダッシュボードで、投稿数、カテゴリー数などの表示を上に移動しました (WordPress のバージョンによらず)。</li>
</ul></li>
  <li>イー・モバイルのネット接続サービス EMnet への対応を盛り込みました (実機での確認はまだです)。現時点では H11T のモバイルブラウザモードおよび、S11HT の IEMobile での閲覧で、携帯電話向け表示になります。</li>
  <li>携帯電話からのコメント投稿・新規投稿・投稿編集などで絵文字が入力できるようになりました。デフォルトでは無効ですので、管理パネルの「携帯表示」にて、絵文字の入力を「許す」に設定する必要があります。絵文字はデータベースでは <code>&lt;img localsrc="XXXX" /&gt;</code> という形で格納され、PC やスマートフォン等での閲覧時は代替テキストに展開、携帯電話での閲覧時は電話会社に応じた絵文字に適切に変換されます。</li>
  <li>スマイリーから携帯絵文字の変換で、対応テーブルを修正して、より適切なものに変更しました。(ソフトバンク絵文字への変換は不適切なものが多かった)</li>
  <li>テンプレートタグ <code>ks_mb_get_form()</code> が、携帯絵文字を検出して、<code>&lt;img localsrc="XXXX" /&gt;</code> というフォーマットに変換できるようにしました。</li>
  <li>各社 3G 端末、WILLCOM、スマートフォン等で出る「画像を表示する／リンクに変換」のメニューを、表示中ページに画像がない場合は隠すようにしました。</li>
  <li>WordPress コアが、アポストロフィー、ダッシュ、3点リーダーなどを数値実体参照に変換しても、普通の文字に戻すようにしました (数値実体参照は携帯電話で文字化けする場合が多いため)。</li>
  <li>携帯電話からの新規投稿／投稿編集で、コメント・ピンバックの許可・拒否を設定できるようにしました。「投稿を削除」はボタンではなくリンクにしました (WordPress 2.5 風)。</li>
  <li>携帯電話でのコメント編集で、メールアドレス欄を追加しました (なぜか今までありませんでした)。「コメントを削除」はボタンではなくリンクにしました (WordPress 2.5 風)。</li>
  <li>携帯電話用の管理パネルで、コメントの「一括編集モード」を廃止しました。</li>
  <li>携帯電話用のページ分割で、ol 要素の途中で分割された場合、ol 要素の start 属性を用いて、項目番号を前ページから継続させるようにしました。前ページが8番目の途中で分割された場合、現在ページは 8 という項目数字から始まります。従来は、2ページ目以降の項目番号が1番にリセットされてしまっていました。また、ソフトバンク絵文字の途中で分割された場合、分割点以後の表示が乱れてしまう問題を修正しました。</li>
  <li>外部リンクへの中継ページで、クエリ文字列 (? や &amp; など) を含む URL が途中で切れてしまう問題を修正しました。また、i-mode, EZweb の場合、URL のコピーをしやすいようにテキストフィールドを付けました (ソフトバンクはテキスト中の URL を直接コピーしてください)。</li>
  <li>附属テーマにおいて、絵文字の代替文字列が抜けていた (<code>&lt;img localsrc="XXXX" /&gt;</code> となっていた) 部分に <code>alt=""</code> を追加しました。代替文字列がない場合、services.php で定義した代替文字を出すようになったための対応です。もし、自作テーマで <code>&lt;img localsrc...</code>を使っている場合は修正が必要です。</li>
  <li>標準のパーマリンクを使用している場合、SoftBank PDC 等の古い端末において、コメント閲覧・コメント投稿などのリンクがうまく動かなかった問題を改善しました。</li>
  <li>W-ZERO3 シリーズ、EM・ONE、htc Z 等の Windows Mobile スマートフォンにおいて、<code>ks_term_name()</code> が適切な機種名ではなく「Windows CE;」という文字列を返していた問題を修正しました。(バージョン 1.10, 1.11 のみのバグ)</li>
  <li>全テーマの page.php で余分な div 要素が出ないよう調整しました (実際には、Ktai Style コアが余剰な div 要素を削除しているので、表示上は変化ありません)。</li>
  <li>default テーマで index.php が表示する投稿本文は先頭1000バイトのみに短縮しました。投稿本文が長い場合でもページ分割が起きなくなります。</li>
  <li>compact, default テーマ、携帯管理画面で、カテゴリーを表すアイコンを「王冠」にしました。従来の「電球」はタグを示すアイコンと同じだったため、変更しました。</li>
  <li>redportal テーマで、コメント停止中の投稿において、コメント一覧ページの hr 要素がダブってしまう問題を修正しました。</li>
  <li>標準テンプレートタグ <code>the_excerpt(), get_the_excerpt()</code> において、投稿本文から抜粋に変換する処理を、マルチバイト文字を考慮した処理に差し替えるようにしました。(WordPress 本家版／日本語版ではうまく抜粋が作られないため)</li>
  <li>テンプレートタグ <code>ks_ordered_list(), ks_comments_link(), ks_comments_post_link(), ks_back_to_post()</code> は、絵文字 (数字、四角、矢印等) の直後からリンクを張るようにしました (絵文字自体はリンクされません)。</li>
  <li>WordPress 確認ウィンドウ (コメントエラーや外部サイト接続確認などの表示) で XHTML 文法違反になることがあった問題を修正しました。</li>
  <li>次の独自フィルターフックフィルターフックを追加しました: <code>detect_agent, redir, smiley_table, pictogram_table, convert_pict_other</code></li>
  <li>次のテンプレートタグを追加しました: <code>ks_get_content(), ks_service_type(), ks_is_flat_rate(), ks_is_menu(), ks_is_image_inline(), ks_added_inline_image(), ks_has_inline_images(), ks_applied_appl_xhtml()</code></li>
</ul></dd>
<dt id="ver111">ver 1.11 (2008-02-27)</dt>
<dd><ul>
  <li>admin フォルダーをサーバーに転送しなかった場合 (管理機能を使わない場合) でも、<a href="http://wordpress.org/extend/plugins/mobileadmin/">iPhone / Mobile Admin</a> プラグインが存在する場合は、PC 向け管理画面が使えるようにしました (従来は、管理機能を使わない場合でも PC 向け管理画面へのアクセスを許すプラグインは <a href="http://wphoneplugin.org/">WPhone Admin Plugin</a> だけでした)。</li>
  <li>バージョン 0.99〜1.10 の redportal テーマで「コメントを書く」の前の数字絵文字がダブっていたのを修正しました。</li>
  <li>テンプレートタグ <code>ks_previous_post_link(), ks_next_post_link(), ks_previous_posts_link(), ks_next_posts_link(), ks_posts_nav_link(), ks_posts_nav_multi(), ks_comments_link(), ks_comments_post_link(), ks_back_to_post()</code> で、アクセスキーを指定できるようにしました (従来は、*, #, なし、の決め打ちでした)。また、<code>ks_next_posts_link()</code> は引数 <code>$max_page</code> の位置を変更しました。</li>
  <li><code>ks_ordered_link()</code> を使った場合、数字のアクセスキーが効かない問題を修正しました (バージョン 1.10 のみ存在するバグ)。</li>
</ul></dd>
<dt id="ver110">ver 1.10 (2008-02-25)</dt>
<dd><ul>
  <li>画像の扱いを改善しました。<ol>
  <li>FOMA, EZweb WAP2.0 機, SoftBank 3G, WILLCOM, その他端末では、画像をリンクにせず長辺が96ピクセルのサムネール (容量は 2.5KB 程度) を生成してインライン表示させるようにしました。</li>
  <li>mova, EZweb HDML 端末、SoftBank PDC 端末は従来通り、画像へのリンクとしますが、WordPress が作成したサムネールへのリンクの場合、容量が大きくて端末で表示できないと推測されるときは、Ktai Style が作成した96ピクセルのサムネールへのリンクに差し替えます (リンクがグレーアウトしなくなった)。</li>
  <li>元画像が PNG (または GIF) 画像の場合、同じサイズの GIF (または PNG) 画像および、PNG, GIF 両方の小型サムネール (96ピクセル) を作成するようにしました。これにより、PNG が閲覧できない i-mode 端末、GIF が閲覧できない SoftBank PDC 端末でも画像が見られます。</li>
  <li>画像をサムネール化／リンク化するとき、シンボリックリンク等で、WordPress インストールディレクトリー外のディレクトリーを呼び出している場合でも、できる限り探し出すようにしました。例えば、http://example.jp/blog/ に WordPress をインストールしていて、http://example.jp/photos/ に画像を入れている場合、従来は外部サーバーの画像と同じ扱いでしたが、今バージョンから、サムネールを作成したり、「元画像(xxKB)」のようなリンクになったりします。</li>
  <li>EZweb の画像表示可能サイズとして HTTP ヘッダの HTTP_X_UP_DEVCAP_MAX_PDU を利用するようにしました。この値が読めない場合は従来通り、HDML 端末で 48KB, WAP2.0 端末で 100KB が上限となります。</li>
</ol></li>
  <li>PC 向けページのヘッダに <a href="http://www.sixapart.jp/docs/tech/mobile_link_discovery_ja.html">Mobile Link Discovery</a> を挿入するようにしました。Google モバイル、Livedoor ブログ等、Mobile Link Discovery に対応したサービスの携帯ページから Ktai Style をインストールしたブログにリンクしている場合、Ktai Style による出力が表示されるようになるはずです。</li>
  <li>携帯電話用にページ分割して2ページ目以降を閲覧しているとき、<code>ks_previous_posts_link(), ks_next_posts_link(), ks_posts_nav_link()</code> (ナビゲーションリンク) の出力に、現在の分割ページ番号を含んでしまっていた問題を修正しました (リンク先は常に1ページ目を指すようになった)。</li>
  <li>「その他」端末で「PC 表示にする」をクリックして携帯表示を終了させたときは、テンプレートタグ <code>is_ktai()</code> が FALSE を返すようにしました。</li>
  <li><code>ks_is_front()</code> は、独自テンプレートの menu_XXXX.php (年月アーカイブ／カテゴリー一覧／タグクラウド／ページ一覧／ブログロール／最近のコメント) を表示しているときに FALSE となるようにしました (従来は TRUE になっていました)。</li>
  <li><code>ks_get_recent_comments()</code> に第3引数 <code>$group_by_post</code> を追加しました。最新コメントを純粋に受信日時順にできます (投稿 ID でまとめないことが可能)。</li>
  <li>携帯電話でアクセスしたとき、<a href="http://wordpress.org/extend/plugins/wp-spamfree/">WP-SpamFree</a> プラグインが起動しないようにしました。</li>
  <li>classic, compact, default テーマのフッタで「plug-in」という誤記を修正しました。</li>
  <li>classic テーマで、存在しないカテゴリー・タグ・日付などを表示しようとしたとき、hr 要素がダブってしまう表示を修正しました。</li>
  <li>管理画面で、重要な変更を加えるときなど「WordPress 確認画面」が出たとき、変更結果が文字化けすることがあった問題を修正しました。例えば、投稿やコメントを編集するときに nonce が合致しなかったときなど「WordPress 確認画面」が出ますが、「はい」ボタンを押したときに編集結果が文字化けしてしまっていました。</li>
  <li>ktai_style.php で KS_DELETE_EXTERNAL_LINKS 定数を定義すると、一律に外部リンクを削除できる機能を削除しました。そのかわり、<a href="CUSTOMIZE.ja.html#del_ext">external_links フィルターフックを使って外部リンクを削除する方法</a>を提案しています。</li>
  <li><code>ks_posts_nav_link()</code> テンプレートタグで、前後ページを示す文字列を指定できるようにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_pict_char_number()</code></li>
</ul></dd>
<dt id="ver101">ver 1.01 (2008-02-18)</dt>
<dd><ul>
  <li>携帯テーマに style.css が存在しないときの動作を改善しました。現在のテーマに style.css がないとき、携帯電話テーマを default に差し替えるようにして、PC 版テーマが default に戻る挙動は回避されるようにしました。管理画面では style.css がないテーマは認識しないようにしました。</li>
  <li>ホスト名直下に WordPress をインストールしているとき、WordPress テンプレートタグ <code>get_stylesheet_directory_uri(), get_template_directory_uri()</code> および Ktai Style 独自テンプレートタグ <code>ks_theme_url()</code> の返り値で先頭にスラッシュがダブっていたのを修正しました。端末によってはテーマの画像などが正しく読まれなかったのが直ります。</li>
  <li><code>ks_use_appl_xhtml()</code> の適用対象から WILLCOM を外しました。バージョン 0.99 まで非対象、バージョン 1.00 で対象としましたが、インラインスタイルシートが認識されないため適用中止とします。</li>
  <li>WordPress 2.3.x の場合、携帯管理画面の「コメント編集 (閲覧モード)」「コメント編集 (一括編集モード)」「コメント承認」で "Previous Page", "Next Page" がローカライズされていなかったのを修正しました。</li>
</ul></dd>
<dt id="ver100">ver 1.00 (2008-02-16)</dt>
<dd><ul>
  <li>附属ドキュメントを HTML 書類にしました。また、「よくある質問と答え」(Q_and_A.html) を添付しました。</li>
  <li>ウェブログ URL の配下にある画像すべてに対して、サイズが大きくて閲覧中の端末で表示できないと推測される場合、リンクにせず、alt 文字列やファイルサイズを表示するようにしました (従来は、サムネールにリンクした元画像だけサイズを確認していました)。</li>
  <li>ドコモ、KDDI の場合も、外部サイトへのリンクは中継ページを出すようにしました。FOMA または KDDI の WAP2.0 対応端末の場合は、中継ページにフルブラウザ／PC サイトビューアーでの閲覧リンクも出ます。</li>
  <li>スマートフォン等「その他」端末において、携帯向けログインフォームからも PC 用ログインフォームに移動できるようにしました (従来は、ウェブログ画面のみから PC 向け表示への切り換えができた)。</li>
  <li>携帯テーマにおいて style.css ファイルを必須ファイルとしました。自作携帯テーマを使っているときはアップグレード時に style.css を作ってやる必要があります。さもないと、PC 版テーマが default に戻ってしまいます。</li>
  <li>固定ページで、ページテンプレートの指定を反映するようにしました。PC 向けテーマで使用しているページテンプレートと同じ名前で、携帯テーマのディレクトリーにページテンプレートを作成してください。もしページテンプレートがなければ、page.php を探し、なければ index.php を使用します。</li>
  <li>定数 <code>TEMPLATEPATH, STYLESHEETPATH</code> に携帯テーマへのパスが入るようにしました。このため、<code>get_template(), get_stylesheet()</code> 等のテンプレートタグでも携帯サイトのテーマ名が得られます。また、現在の PC 版テーマにある function.php が実行されなくなります。</li>
  <li>全テーマの header.php で html 要素から xmlns, xml:lang, lang 属性を削除しました。xmlns 属性はテンプレートタグ <code>ks_use_appl_xhtml()</code> を使うと挿入されます。</li>
  <li>compact, default テーマの index.php, single.php で、記事の上にある日付に下線を入れるのをやめました (i-mode は u 要素非対応のため)。</li>
  <li>redportal テーマの footer.php で dt 要素の閉じ忘れがあったのを修正しました。</li>
  <li><code>ks_use_appl_xhtml()</code> を使ったとき、b,i,u,em,strong 要素と font 要素の入れ子は、b,i,u,em,strong 要素に style 属性を付けるような変換としました (従来は font 要素を単純に span style に変換していました)。これにより、SoftBank 3G にて、文法違反が解消されました。</li>
  <li><code>ks_use_appl_xhtml()</code> を使ったとき、hr 要素のスタイルシート変換を改善しました。(color, width の順序を不問にし、align にも対応した)</li>
  <li>SoftBank 端末で絵文字数字[1]や[3]を含むページをページ分割した際、XHTML が不正になる問題を修正しました。</li>
  <li>SoftBank 6-3 シリーズにおいて、見出し要素 (h1 - h6) を div 要素に変換させるようにしました。(従来は p 要素に変換していましたが、align 属性が無効なため変更しました)</li>
  <li>img 要素の alt 要素などで、特定の文字 (「キ」や「業」など) が破壊されてしまう不具合を修正しました。</li>
  <li>1x1 ピクセルの画像 (アフィリエイトやレイアウト調整用) を非表示にする機能が有効になっていなかったバグを修正しました。</li>
  <li>WordPress の一般設定で、「ブログのアドレス」(get_option('home')の値) を設定していないとき、ハイパーリンクが不正になることがある問題を修正しました。</li>
  <li>次の独自フィルターフックを追加しました: <code>external_link</code></li>
  <li><code>strip_links</code> フィルターフックを <code>convert_links</code> に改名しました。</li>
</ul></dd>
<dt id="ver099">ver 0.99 (2008-02-02)</dt>
<dd><ul>
  <li>動作条件を PHP 5.2.0 以降としました。実は以前から PHP 5.1.6 以前で動かなかったのですが、明記されていませんでした。</li>
  <li>README ファイルを README-ja_utf8.txt から README-ja.txt に名称変更しました。</li>
  <li>au の機種判別で新機種の追加と誤記の訂正をしました。</li>
  <li>default, compact, redportal テーマでは、コメント投稿時に必須事項 (コメント本文、名前、携帯電話情報など) が記入されてないとき、コメントフォームを再び表示してその上部にエラーを出すようにしました。すでに入力した内容が残るようになります。</li>
  <li>全テーマの header.php に style 要素を追加して、EZweb の WAP2.0 対応端末でも p 要素同士の間に空行を作るようにしました。i-mode, SoftBank 端末では従来から空行がありましたが、EZweb では詰まって表示されていました。</li>
  <li>フロントページ (ウェブログのトップページ) は、端末のキャッシュに残さないようにしました (au 端末はキャッシュが長く残るため、最新記事を見るには都度ページ更新が必要だった)。</li>
  <li>UTF-8 で記述されたハートマーク等のトランプマーク、および &amp;hearts; 等の実体参照を絵文字に変換するようにしました。</li>
  <li>管理画面の「携帯表示」設定で、オプション値を削除してデフォルトに戻せるようにしました。</li>
  <li>言語リソースが読まれていないとき (wp-config.php で WPLANG が ja_UTF なのに ktai_style-ja.mo をリネームしていないとき)、携帯電話からコメント投稿すると文字化けすることがありましたが、現象が発生しないよう対策しました。</li>
  <li>admin フォルダーをサーバーに転送しなかった場合 (管理機能を使わない場合)、携帯電話から通常のログイン画面・管理画面へのアクセスも遮断するようにしました。</li>
  <li>閲覧日と同じ日付の投稿は時刻だけ表示する仕様のはずでしたが、実際には月日も表示していたバグを修正しました (時刻だけ表示に直しました)。</li>
  <li>投稿管理画面やコメント管理画面で、投稿やコメントを編集して保存した際、元の画面ではなくログイン画面に戻ってしまうことがある不具合を修正しました。</li>
  <li>EZweb 端末で、投稿本文が Shift_JIS 換算で 1024 バイト以上のとき、携帯電話で編集すると末尾が切られてしまうため、編集画面で警告を出すようにしました。</li>
  <li>EZweb 端末で、WAP2.0 対応機と HDML 対応機を判別できるようにしました (テーマファイルは共通のままです)。</li>
  <li>SoftBank PDC 端末において、投稿タイトルが長い場合に編集時に末尾が切れてしまうことがある問題を修正しました。</li>
  <li>SoftBank 用エミュレーター (ウェブコンテンツヴューア) からの閲覧でも携帯電話表示になるようにしました。</li>
  <li>標準のパーマリンク構造 (/?p=1234 などの形式) を使っているサイトでパスワード保護した場合、端末によっては、正しいパスワードを送信してもパスワード解除できないことがある現象を修正しました。</li>
  <li>ウィルコム端末、その他端末 (スマートフォン等) での DOCTYPE 宣言を XHTML Basic ではなく、XHTML 1.0 Strict に変更しました。</li>
  <li><code>ks_comments_list_link()</code> テンプレートタグで、パスワード保護した投稿で保護解除状態のとき、絵文字とボタンの間が改行されないようにしました。</li>
  <li><code>ks_comments_link()</code> テンプレートタグに、引数 <code>$accesskey</code> を追加しました。</li>
  <li><code>ks_comment_post_link()</code> テンプレートタグに、引数 <code>$icon, $accesskey</code> を追加しました。</li>
  <li><code>ks_get_recent_comments()</code> テンプレートタグで、<code>$type</code> を pingback と指定しても、trackback+pingback を指定したときと同じ動作になっていたバグを修正しました。</li>
  <li>次の独自フィルターフックフィルターフックを追加しました: <code>allowedtags, leave_scheme, strip_links, image_to_link</code></li>
  <li>次のテンプレートタグを追加しました: <code>ks_inline_error_submit()</code></li>
</ul></dd>
<dt id="ver098">ver 0.98 (2007-12-27)</dt>
<dd><ul>
  <li>WordPres 2.3 以降で、投稿の本文表示でのキーワードタグの表示およびタグクラウドの表示に対応しました。</li>
  <li>携帯電話キャリアごとにテーマを変更できるようにしました。</li>
  <li>コメント投稿時に端末識別情報 (電話機製造番号、EZ番号等) を要求できるようにしました。</li>
  <li>各テーマに functions.php が存在するとき、読み込んで実行するようにしました。</li>
  <li>ドコモ FOMA で、i-mode XHTML で表示させるのをやめました (全キャリア text/html で表示)。ただし、<code>ks_use_appl_xhtml()</code> タグを使うと、application/xhtml による表示になります。</li>
  <li>画像にウェブサイトへのリンクを張っているとき、画像へのリンクの後ろに、ウェブサイトへのリンクを追加するようにしました (従来はリンクを削除していました)。</li>
  <li>ソフトバンク絵文字で、絵文字が続くときエスケープシーケンスを省略するようにしました (わずかながらパケット節約)。</li>
  <li>classic テーマでは、(いわゆる) 全角カタカナを半角に変換するようにしました。</li>
  <li>PNG 画像や GIF 画像に <code>class="ktai"</code> を付与してそのまま出力させたとき、i-mode では GIF 画像、Softbank PDC では PNG 画像を表示させるようにしました (あらかじめ同一ファイル名で PNG, GIF それぞれの画像を用意する必要があります)。</li>
  <li>画像に <code>class="ktai"</code> を付与してそのまま出力させたときでも、ページの全体サイズが携帯端末の表示容量を越える場合は、画像を alt テキストの内容に置換して容量制限に収まるようにしました。</li>
  <li>プラグインを有効にするとき WordPress Database Error が発生することがある問題を修正しました。</li>
  <li>Nokia, Opera Mini, PSP, Nintendo DS において、<code>ks_term_name()</code> テンプレートタグの出力を適切なものにしました (従来は N/A になっていた)。</li>
  <li><code>is_mobile()</code> 関数の提供をやめて、<code>is_ktai()</code> 関数に一本化しました。</li>
  <li>独自フィルターフック <code>raw_content, encoding_converted, split_page</code> を定義しました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_theme_url(), ks_use_appl_xhtml(), ks_is_required_term_id(), ks_require_term_id_form(), ks_tags(), ks_tag_cloud()</code></li>
</ul></dd>
<dt id="ver097">ver 0.97 (2007-12-15)</dt>
<dd><ul>
  <li>テーマ切り替え機能をつけました。複数のテーマを用意しておき、簡単に使い分けることができます。これにより、サンプルテンプレートの提供はやめました。</li>
  <li>外部サイトへのリンクは、一律にフルブラウザ閲覧リンクまたは中継ページ経由リンクに変換することとしました。</li>
  <li>検索結果ページで、検索語句を表示させるようにしました。</li>
  <li>設定パネルのデザインを少し変更しました。文字色はリアルタイムに色見本を確認できるようになりました。</li>
  <li>admin フォルダーをサーバーに設置しなかった場合、外部サイトへのリンクがある投稿・ページで PHP エラーが出てしまうバグを修正しました。 </li>
  <li>携帯電話でログインしたとき、セッション情報として保存する端末情報 (ユーザーエージェント、端末ID、契約者ID) をハッシュ化するようにしました (セキュリティー強化)。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_is_loggedin(), ks_force_text_html(), ks_fix_encoding_form(), ks_detect_encoding(), ks_mb_get_form()</code></li>
</ul></dd>
<dt id="ver096">ver 0.96 (2007-12-04)</dt>
<dd><ul>
  <li>最新記事一覧やアーカイブ一覧で、タイトルの後ろにコメント数を表示するようにしました。また、アーカイブでの記事一覧を番号つきリストにしました。</li>
  <li>コメント投稿にログインできるようにしました。コメント投稿にログインを必須とするサイトでも携帯電話からコメントできます。</li>
  <li>i-mode, EZweb、ウィルコムでの絵文字をバイナリ埋め込み方式にしました。パケット量がわずかに削減されます。</li>
  <li>外部サイトへのリンクの扱いを改善しました (ドコモでフルブラウザ非対応機種は中継ページを表示させるようにした etc)。</li>
  <li>プラグインを無効にしたとき、セッション管理用のテーブルをデータベースから削除するようにしました。</li>
  <li>デフォルトのパーマリンク構造の場合、コメント投稿フォームが出なかったバグを修正しました。</li>
  <li>キーワードタグで日本語が使えなかった問題を修正しました。</li>
  <li>XHTML の文法違反があったのを修正しました。</li>
  <li>WordPress 確認ウィンドウの処理が不適切だったことがあるのを修正しました。</li>
  <li>附属テンプレートで、日本語を直接埋め込んだ箇所を大幅に減らしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_get_logout_url(), ks_session_id_form(), ks_comments_post_url()</code></li>
  <li><code>ks_plugin_dir()</code> タグを <code>ks_plugin_url()</code> に改名しました。</li>
</ul></dd>
<dt id="ver095">ver 0.95 (2007-11-27)</dt>
<dd><ul>
  <li>Windows Mobile など「その他」端末では、PC 表示に切り替えられるようにしました。(ただし、クッキー未対応端末では切り替わりません)。</li>
  <li>ドコモ FOMA では、i-mode XHTML で表示させるようにしました。少し見栄えが違っているかもしれません。</li>
  <li>au の機種判別で新機種など追加しました。</li>
  <li>WordPress 2.3 以降では、キーワードタグの入力・編集をできるようにしました。</li>
  <li>XML 宣言が文法ミスだったのを修正しました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_mimetype(), ks_switch_pc_view()</code></li>
</ul></dd>
<dt id="ver094">ver 0.94 (2007-11-18)</dt>
<dd><ul>
  <li>各種スマートフォン、PSP, NDS のページ容量を 50KB に拡大しました。</li>
  <li>新規投稿時、投稿編集時にカテゴリーを変更できるようにしました。</li>
  <li>デフォルトカテゴリー、メール投稿時カテゴリーの設定をできるようにしました。</li>
  <li>ログイン直後、画面が真っ白または PHP のエラーが表示されることがある問題を修正しました。</li>
  <li>投稿編集のカテゴリー表示で、親カテゴリーを持つカテゴリー (第2階層以下のカテゴリー) が表示されない問題を修正しました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_get_wp_version()</code></li>
</ul></dd>
<dt id="ver093">ver 0.93 (2007-11-16)</dt>
<dd><ul>
  <li>サイト管理機能を実装しました。新規投稿・投稿編集・コメント管理が可能です。</li>
  <li>PSP, Nintendo DS も携帯電話向け表示をさせるようにしました。</li>
  <li>Windows CE, Windows Mobile はすべて携帯電話向け表示をさせるようにしました。</li>
  <li>コメント投稿・新規投稿・投稿編集など、携帯電話から送信された文字列を UTF-8 に変換させるとき、SJIS-win ではなく SJIS とみなして変換させるようにしました (波ダッシュが全角チルダになるのを防ぐため)。</li>
  <li><a href="http://wphoneplugin.org/">WPhone Admin Plugin</a> が存在する場合、<code>is_mobile()</code> 関数のかわりに <code>is_ktai()</code> 関数を定義するようにしました。</li>
  <li><code>ks_orderd_link()</code> タグを <code>ks_ordered_link()</code> とスペルミス修正しました。</li>
</ul></dd>
<dt id="ver092">ver 0.92 (2007-10-20)</dt>
<dd><ul>
  <li>サンプルテンプレートを添付しました。</li>
  <li>archive.php (年月アーカイブ等の表示) において、ポップアップ (ドロップダウン)</li>
  <li>メニュー式ページナビゲーションを導入しました。何十ページでも一挙に移動できます。</li>
  <li>alt 文字列が空の画像や 1 x 1 ピクセルの画像 (アフィリエイトやレイアウト調整用) はリンクせず無視するようにしました。</li>
  <li>del 要素はテキスト自体を削除するようにしました (多くの端末では取り消し線はサポートされず、del 要素かどうか区別が付かないため)。</li>
  <li>i モードの場合、外部サイトへのリンクを削除ではなく、フルブラウザでの閲覧リンクと設定できるようにしました。</li>
  <li>EM・ONE の Internet Explorer も携帯電話として認識するようにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_posts_nav_multi(), ks_posts_nav_dropdown()</code></li>
</ul></dd>
<dt id="ver091">ver 0.91 (2007-10-11)</dt>
<dd><ul>
  <li>各記事のコメントとトラックバック・ピンバックも分離できるようにしました。</li>
  <li>サムネール画像に元画像のリンクが設定されている場合、元画像へのリンクを付与するようにしました。</li>
  <li>ページ分割をより自然になるよう改善しました。</li>
  <li>ウィルコム端末で、できるだけウィルコム独自の絵文字を使うようにしました (対応する絵文字がない場合は従来通り i モード互換絵文字)。</li>
  <li>W-ZERO3 は絵文字非対応っぽいので、ウィルコムではなく「その他」端末として認識させるようにしました。また、ドコモ htcZ 、ソフトバンク X シリーズも携帯電話向け出力を行うようにしました。</li>
  <li>携帯電話の機種名を取得・表示できるようにしました (<code>ks_term_name()</code> タグ)。</li>
  <li>3G 端末では、電話会社ごとに DOCTYPE 宣言を変えるようにしました。</li>
  <li>XHTML 不要タグの除去を <code>wp_kses()</code> を使って厳密に行えるようにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_term_name(), ks_charset()</code></li>
  <li><code>ks_comments_list_link()</code> を <code>ks_get_comments_list_link()</code> に改名しました。</li>
</ul></dd>
<dt id="ver090">ver 0.90 (2007-10-03)</dt>
<dd><ul>
  <li>ページ容量が大きい場合、5KB〜30KB ごとにページ分割するようにしました。</li>
  <li>ソース内の日本語表記を言語リソースに分離しました。</li>
  <li>au、ウィルコムの場合に外部サイトへのリンクを残せるようにしました。</li>
  <li><a href="http://www.neato.co.nz/ultimate-tag-warrior/">Ultimate Tag Warrior</a> 等、プラグインのアイコンは、画像へのリンクとせず alt 文字列の表示としました。</li>
  <li>ブックマーク(ブログロール)一覧を表示できるようにしました。(テンプレートの改造が必要)</li>
  <li>ホスト名直下に WordPress をインストールしている環境で、アーカイブ一覧、カテゴリー一覧のリンクが不正だった不具合を修正しました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_list_bookmarks()</code></li>
</ul></dd>
<dt id="ver083">ver 0.83 (2007-09-30)</dt>
<dd><ul>
  <li>最新コメント一覧を表示できるようにしました。</li>
  <li>設定画面を用意しました。ただし、設定できる内容は <a href="http://hrlk.com/script/mobile-eye-plus/">Mobile Eye+</a> と異なります。</li>
  <li>日付表示で、今年と同じ年ならば年を省略、今日と同じ年月日ならば日付を省略するようにしました。</li>
  <li>他プラグインで携帯電話出力か確認できるよう <code>is_mobile()</code> 関数を定義しました。</li>
  <li>画像に <code>class="ktai"</code> が付与されている場合はそのまま表示させるようにしました。</li>
  <li>xx_home.php テンプレートを廃止しました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_option(), ks_time(), ks_comment_datetime(), ks_comments_list_link(), ks_recent_comments()</code></li>
</ul></dd>
<dt id="ver082">ver 0.82 (2007-09-28)</dt>
<dd><ul>
  <li>検索フォームに対応しました。</li>
  <li>WordPress 内蔵のスマイリーは携帯電話絵文字に変換して表示させるようにしました。</li>
  <li>&lt;!--nextpage--&gt; を使った投稿でも正しく表示されるようにしました。</li>
  <li>ページ内リンク (&lt;a href="#top"&gt; のような # を使ったリンク)、mailto:, tel: スキームを使ったリンクを削除せず残すようにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_link_pages(), ks_back_to_post()</code></li>
</ul></dd>
<dt id="ver081">ver 0.81 (2007-09-24)</dt>
<dd><ul>
  <li>フロントページを記事一覧だけのスタイルにできる xx_home.php を添付しました。</li>
  <li>コメント一覧／コメント投稿フォームのテンプレートを合体して comments.php にしました。WordPress 標準に近い型式となりました。</li>
  <li>パーマリンク構造がデフォルトの場合、コメント閲覧・投稿ができない不具合を修正しました。</li>
  <li>ホスト名直下に WordPress をインストールしている環境でコメント投稿できないことがある問題を修正しました。</li>
  <li>コメント一覧でも外部サイトへのリンクを除去するようにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_is_comments_list(), ks_is_comment_post(), ks_is_comments()</code></li>
  <li>次のテンプレートタグを廃止しました: <code>ks_comments_setup()</code></li>
</ul></dd>
<dt id="ver080">ver 0.80 (2007-09-23)</dt>
<dd><ul>
  <li>コメントの表示・投稿に対応しました。</li>
  <li>パスワード保護された投稿に対応しました。</li>
  <li><code>ks_content()</code> タグを復活させました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_siteurl(), ks_plugin_dir(), ks_check_password(), ks_comments_setup(), ks_comments_link(), ks_comments_post_link(), ks_back_to_post()</code></li>
</ul></dd>
<dt id="ver071">ver 0.71 (2007-09-22)</dt>
<dd><ul>
  <li>固定ページに対応しました。フッターにページ一覧メニューが出ます。</li>
  <li><code>ks_content(), ks_list_categories()</code> タグを廃止して、それぞれ <code>the_content(), wp_list_categories()</code> の出力を携帯電話向けに自動変換させるようにしました。</li>
  <li>見出し要素 (h1 - h6) は SoftBank 6-3 シリーズ未対応なので、p 要素に変換させるようにしました。</li>
  <li>Opera Mini, Nokia, EM・ONE など、携帯電話向け表示を行う端末を増やしました。</li>
  <li>php.ini で <code>short_open_tag = On</code> という設定のサーバーで構文エラーが出ないようにしました。</li>
  <li>index.php テンプレートにおいて、ドコモ端末で「↓9.最新の記事」リンクが効かなかったのを修正しました。</li>
  <li>index.php, single.php のテンプレートにおいて、投稿者を示す絵文字をユニセックスなものにしました。</li>
  <li>次のテンプレートタグを追加しました: <code>ks_title(), ks_pages_menu(), ks_is_front()</code></li>
</ul></dd>
<dt id="ver070">ver 0.70 (2007-09-19)</dt>
<dd><ul>
  <li>新規リリース。</li>
</ul></dd>
</dl>
</body>
</html>
